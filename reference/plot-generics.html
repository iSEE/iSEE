<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generics for DotPlot plotting — plot-generics • iSEE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generics for DotPlot plotting — plot-generics"><meta property="og:description" content="A series of generics for controlling how plotting is performed in DotPlot panels.
DotPlot subclasses can specialize one or more of them to modify the behavior of .generateOutput."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iSEE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic.html">An introduction to the `r Biocpkg("iSEE")` interface 
</a>
    </li>
    <li>
      <a href="../articles/bigdata.html">How to use `r Biocpkg("iSEE")` with big data
</a>
    </li>
    <li>
      <a href="../articles/configure.html">Configuring `r Biocpkg("iSEE")` apps
</a>
    </li>
    <li>
      <a href="../articles/custom.html">Deploying custom panels in the `iSEE` interface</a>
    </li>
    <li>
      <a href="../articles/ecm.html">Describing the `ExperimentColorMap` class</a>
    </li>
    <li>
      <a href="../articles/links.html">Sharing information across `r Biocpkg("iSEE")` panels
</a>
    </li>
    <li>
      <a href="../articles/voice.html">Controlling the `iSEE` interface using speech recognition</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/iSEE/iSEE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generics for DotPlot plotting</h1>
    <small class="dont-index">Source: <a href="https://github.com/iSEE/iSEE/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a></small>
    <div class="hidden name"><code>plot-generics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A series of generics for controlling how plotting is performed in <a href="DotPlot-class.html">DotPlot</a> panels.
<a href="DotPlot-class.html">DotPlot</a> subclasses can specialize one or more of them to modify the behavior of <code><a href="output-generics.html">.generateOutput</a></code>.</p>
    </div>


    <div id="generating-plotting-data">
    <h2>Generating plotting data</h2>
    

<p><code>.generateDotPlotData(x, envir)</code> sets up the data to use in the <a href="DotPlot-class.html">DotPlot</a> plot.
The following arguments are required:</p><ul><li><p><code>x</code>, an instance of a <a href="DotPlot-class.html">DotPlot</a> subclass.</p></li>
<li><p><code>envir</code>, the evaluation environment in which the data.frame is to be constructed.
This can be assumed to have <code>se</code>, the SummarizedExperiment object containing the current dataset;
possibly <code>col_selected</code>, if a multiple column selection is being transmitted to <code>x</code>;
and possibly <code>row_selected</code>, if a multiple row selection is being transmitted to <code>x</code>.</p></li>
</ul><p>A method for this generic should add a <code>plot.data</code> variable in <code>envir</code> containing a data.frame with columns named <code>"X"</code> and <code>"Y"</code>, denoting the variables to show on the x- and y-axes respectively.
It should return a list with <code>commands</code>, a character vector of commands that produces <code>plot.data</code> when evaluated in <code>envir</code>;
and <code>labels</code>, a list of strings containing labels for the x-axis (named <code>"X"</code>), y-axis (<code>"Y"</code>) and plot (<code>"title"</code>).</p>
<p>Each row of the <code>plot.data</code> data.frame should correspond to one row or column in the SummarizedExperiment <code>envir$se</code> for <a href="RowDotPlot-class.html">RowDotPlot</a>s and <a href="ColumnDotPlot-class.html">ColumnDotPlot</a>s respectively.
Note that, even if only a subset of rows/columns in the SummarizedExperiment are to be shown, there must always be one row in the data.frame per row/column of the SummarizedExperiment, and in the same order.
All other rows of the data.frame should be filled in with <code>NA</code>s rather than omitted entirely.
This is necessary for correct interactions with later methods that add other variables to <code>plot.data</code>.</p>
<p>Any internal variables that are generated by the commands in <code>commands</code> should be prefixed with <code>.</code> to avoid potential clashes with reserved variable names in the rest of the application.</p>
<p>This generic is called by <code>.generateDotPlot</code> (see below), which is in turn called by <code><a href="output-generics.html">.generateOutput</a></code>.
The idea is that developers can specialize <code>.generateDotPlotData</code> to change the data source for a DotPlot subclass without needing to reimplement the entirety of <code>.generateDotPlot</code>.</p>
    </div>
    <div id="generating-the-ggplot-object">
    <h2>Generating the ggplot object</h2>
    

<p><code>.generateDotPlot(x, labels, envir)</code> creates the plot to be shown in the interface.
The following arguments are required:</p><ul><li><p><code>x</code>, an instance of a <a href="DotPlot-class.html">DotPlot</a> subclass.</p></li>
<li><p><code>labels</code>, a list of labels corresponding to the columns of <code>plot.data</code>.
This is typically used to define axis or legend labels in the plot.</p></li>
<li><p><code>envir</code>, the evaluation environment in which the <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> object is to be constructed.
This can be assumed to have <code>plot.data</code>, a data.frame of plotting data.</p>
<p>Note that <code>se</code>, <code>row_selected</code> and <code>col_selected</code> will still be present in <code>envir</code>,
but it is simplest to only use information that has already been incorporated into <code>plot.data</code> where possible.
This is because the order and number of rows in <code>plot.data</code> may have changed since <code>.generateDotPlotData</code>.</p></li>
</ul><p>Methods for this generic should return a list with <code>plot</code>, a <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> object;
and <code>commands</code>, a character vector of commands to produce that object when evaluated inside <code>envir</code>.
This plot will subsequently be the rendered output in <code><a href="output-generics.html">.renderOutput</a></code>.
Note that <code>envir</code> should contain a copy of the <code>plot</code> object in a variable named <code>dot.plot</code> -
see below for details.</p>
<p>Methods are expected to respond to the presence of various fields in the <code>plot.data</code>.
The data.frame will contain, at the very least, the fields <code>"X"</code> and <code>"Y"</code> from <code>.generateDotPlotData</code>.
Depending on the parameters of <code>x</code>, it may also have the following columns:</p><ul><li><p><code>"ColorBy"</code>, the values of the covariate to ue to color each point.</p></li>
<li><p><code>"ShapeBy"</code>, the values of the covariate to use for shaping each point.
This is guaranteed to be categorical.</p></li>
<li><p><code>"SizeBy"</code>, the values of the covariate to use for sizing each point.
This is guaranteed to be continuous.</p></li>
<li><p><code>"FacetRow"</code>, the values of the covariate to use to create row facets.
This is guaranteed to be categorical.</p></li>
<li><p><code>"FacetColumn"</code>, the values of the covariate to use to create column facets.
This is guaranteed to be categorical.</p></li>
<li><p><code>"SelectBy"</code>, a logical field indicating whether the point was included in a multiple selection
(i.e., transmitted from another plot with <code>x</code> as the receiver).
Note that if <code>RowSelectionRestrict=TRUE</code> or <code>ColumnSelectionRestrict=TRUE</code> 
(for <a href="RowDotPlot-class.html">RowDotPlot</a>s and <a href="ColumnDotPlot-class.html">ColumnDotPlot</a>s, respectively),
<code>plot.data</code> will already have been subsetted to only retain <code>TRUE</code> values of this field.</p></li>
</ul><p><code>envir</code> may also contain the following variables:</p><ul><li><p><code>plot.data.all</code>, present when a multiple selection is transmitted to <code>x</code> and <code>RowSelectionRestrict=TRUE</code> or <code>ColumnSelectionRestrict=TRUE</code> (for <a href="RowDotPlot-class.html">RowDotPlot</a>s and <a href="ColumnDotPlot-class.html">ColumnDotPlot</a>s, respectively).
This is a data.frame that contains all points prior to subsetting and is useful for defining the boundaries of the plot such that they do not change when the transmitted multiple selection changes.</p></li>
<li><p><code>plot.data.pre</code>, present when downsampling is turned on.
This is a data.frame that contains all points prior to downsampling (but after subsetting, if that was performed) and is again mainly used to fix the boundaries of the plot.</p></li>
</ul><p>Developers may wish to use the <code><a href="addMultiSelectionCommands.html">.addMultiSelectionPlotCommands</a></code> utility to draw brushes and lassos of <code>x</code>.
Note that this refers to the brushes and lassos made on <code>x</code> itself, not those transmitted from another panel to <code>x</code>.</p>
<p>It would be very unwise for methods to alter the x-axis, y-axis or faceting values in <code>plot.data</code>.
This will lead to uninuitive discrepancies between apparent visual selections for a brush/lasso and the actual multiple selection that is evaluated by downstream functions like <code><a href="processMultiSelections.html">.processMultiSelections</a></code>.</p>
<p>In certain situations, a <a href="DotPlot-class.html">DotPlot</a> subclass may be able to build off a <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> generated by its parent class.
This is easily done by exploiting the fact that methods for this generic are expected to store a copy of their <code>plot</code> <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> object as a <code>dot.plot</code> variable in <code>envir</code>.
A specialized method for the subclass can <code><a href="https://rdrr.io/r/methods/NextMethod.html" class="external-link">callNextMethod</a>()</code> to populate <code>envir</code> with the initial <code>dot.plot</code>, and then just construct and execute commands to add more <span class="pkg">ggplot2</span> layers as desired.</p>
<p>This generic is called by <code>.generateOutput</code> for DotPlot subclasses.
Again, the idea here is that developers can specialize <code>.generateDotPlot</code> to change the plot aesthetics without needing to reimplement the entirety of <code>.generateOutput</code>.</p>
    </div>
    <div id="prioritizing-points">
    <h2>Prioritizing points</h2>
    

<p><code>.prioritizeDotPlotData(x, envir)</code> specifies the “priority” of points to be plotted, where high-priority points are plotted last so that they will not be masked by other points.
The following arguments are required:</p><ul><li><p><code>x</code>, an instance of a <a href="DotPlot-class.html">DotPlot</a> subclass.</p></li>
<li><p><code>envir</code>, the evaluation environment in which the <a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a> object is to be constructed.
This can be assumed to have <code>plot.data</code>, a data.frame of plotting data.</p>
<p>Again, note that <code>se</code>, <code>row_selected</code> and <code>col_selected</code> will still be present in <code>envir</code>, but it is simplest to only use information that has already been incorporated into <code>plot.data</code> where possible.
This is because the order and number of rows in <code>plot.data</code> may have changed since <code>.generateDotPlotData</code>.</p></li>
</ul><p>Methods for this generic are expected to generate a <code>.priority</code> variable in <code>envir</code>, an ordered factor of length equal to <code>nrow(plot.data)</code> indicating the priority of each point.
They may also generate a <code>.rescaled</code> variable, a named numeric vector containing the scaling factor to apply to the downsampling resolution for each level of <code>.priority</code>.</p>
<p>The method itself should return a list containing <code>commands</code>, a character vector of R commands required to generate these variables;
and <code>rescaled</code>, a logical scalar indicating whether a <code>.rescaled</code> variable was produced.</p>
<p>Points assigned the highest level in <code>.priority</code> are regarded as having the highest visual importance.
Such points will be shown on top of other points if there are overlaps on the plot, allowing developers to specify that, e.g., DE genes should be shown on top of non-DE genes.
Scaling of the resolution enables developers to peform more aggressive downsampling for unimportant points.</p>
<p>Methods for this generic may also return <code>NULL</code>, in which case no special action is taken.</p>
<p>This generic is called by <code>.generateDotPlot</code>, which is in turn called by <code><a href="output-generics.html">.generateOutput</a></code>.
Thus, developers of DotPlot subclasses can specialize this generic to change the point priority without needing to reimplement the entirety of <code>.generateDotPlot</code>.</p>
    </div>
    <div id="controlling-the-none-color-scale">
    <h2>Controlling the “None” color scale</h2>
    

<p>In some cases, it is desirable to insert a default scale when <code>ColorBy="None"</code>.
This is useful for highlighting points in a manner that is integral to the nature of the plot, e.g., up- or down-regulated genes in a MA plot.
We provide a few generics to help control which points are highlighted and how they are colored.</p>
<p><code>.colorByNoneDotPlotField(x)</code> expects <code>x</code>, an instance of a <a href="DotPlot-class.html">DotPlot</a> subclass, and returns a string containing a name of a column in <code>plot.data</code> to use for coloring in the <code>ggplot</code> mapping.
This assumes that the relevant field was added to <code>plot.data</code> by a method for <code>.generateDotPlotData</code>.</p>
<p><code>.colorByNoneDotPlotScale(x)</code> expects <code>x</code>, an instance of a <a href="DotPlot-class.html">DotPlot</a> subclass, and returns a string containing a <span class="pkg">ggplot2</span> <code>scale_color_*</code> call, e.g., <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></code>.
This string should end with a <code>"+"</code> operator as additional <span class="pkg">ggplot2</span> layers will be added by <span class="pkg">iSEE</span>.</p>
<p>This generic is called by <code>.generateDotPlot</code>, which is in turn called by <code><a href="output-generics.html">.generateOutput</a></code>.
Thus, developers of DotPlot subclasses can specialize this generic to change the default color scheme without needing to reimplement the entirety of <code>.generateDotPlot</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Kevin “K-pop” Rue-Albrecht, Aaron “A-bomb” Lun</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kevin Rue-Albrecht, Federico Marini, Charlotte Soneson, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

